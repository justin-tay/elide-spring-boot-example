<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd">
    <changeSet author="admin" id="1539122071">
        <sql>
    CREATE TABLE ArtifactGroup (
       name varchar(255) NOT NULL,
       commonName varchar(255) DEFAULT NULL,
       description varchar(255) DEFAULT NULL,
       createdOn timestamp NOT NULL,
       createdBy varchar(255) NOT NULL,
       PRIMARY KEY (name)
    );

    CREATE TABLE ArtifactProduct (
       name varchar(255) NOT NULL,
       commonName varchar(255) DEFAULT NULL,
       description varchar(255) DEFAULT NULL,
       group_name varchar(255) DEFAULT NULL,
       PRIMARY KEY (name),
       FOREIGN KEY (group_name) REFERENCES ArtifactGroup(name)
    );

    CREATE TABLE ArtifactVersion (
       name varchar(255) NOT NULL,
       createdAt timestamp DEFAULT NULL,
       artifact_name varchar(255) DEFAULT NULL,
       PRIMARY KEY (name),
       FOREIGN KEY (artifact_name) REFERENCES ArtifactProduct(name)
    );

    CREATE TABLE AsyncQuery (
       id varchar(36) not null,
       createdOn timestamp,
       principalName varchar(255),
       query varchar(255),
       queryType integer,
       requestId varchar(36),
       status varchar(255),
       updatedOn timestamp,
       contentLength integer,
       responseBody text,
       completedOn timestamp,
       httpStatus integer,
       recordCount integer,
       primary key (id)
    );

    CREATE TABLE TableExport (
       id varchar(36) not null,
       createdOn timestamp,
       principalName varchar(255),
       query varchar(255),
       queryType integer,
       requestId varchar(36),
       resultType varchar(255),
       status varchar(255),
       updatedOn timestamp,
       contentLength integer,
       responseBody text,
       completedOn timestamp,
       httpStatus integer,
       recordCount integer,
       message text,
       url varchar(255),
       primary key (id)
    );

    CREATE TABLE Downloads (
       group_id varchar(255) NOT NULL,
       product_id varchar(255) NOT NULL,
       date timestamp NOT NULL,
       downloads integer NOT NULL,
       FOREIGN KEY (group_id) REFERENCES ArtifactGroup(name),
       FOREIGN KEY (product_id) REFERENCES ArtifactProduct(name)
    );
        </sql>
    </changeSet>
    <changeSet author="admin" id="1539122270">
        <sql>
    INSERT INTO ArtifactGroup (name, commonName, description, createdOn, createdBy) VALUES
       ('com.example.repository','Example Repository','The code for this project', '2020-02-01 00:00:00', 'user'),
       ('com.yahoo.elide','Elide','The magical library powering this project', '2019-02-01 00:00:00', 'user'),
       ('org.springframework.boot','Spring Boot','Spring Boot makes it easy to create stand-alone applications', '2022-02-05 00:00:00', 'user'),
       ('org.springframework.security','Spring Security','Spring Security is a powerful and highly customizable authentication and access-control framework', '2019-02-01 00:00:00', 'user'),
       ('org.springframework.cloud','Spring Cloud','Spring Cloud provides tools for developers to quickly build some of the common patterns in distributed systems', '2020-06-05 00:00:00', 'user');

    INSERT INTO ArtifactProduct (name, commonName, description, group_name) VALUES
       ('elide-core','Core','The guts of Elide','com.yahoo.elide'),
       ('elide-datastore-hibernate5','Hibernate5 Datastore','A datastore that uses Hibernate 5 to communicate with the database','com.yahoo.elide'),
       ('elide-standalone','Standalone','A pre-configured, standalone Elide webservice','com.yahoo.elide');

    INSERT INTO ArtifactVersion (name, artifact_name) VALUES
       ('1.0.0','elide-standalone'),
       ('2.0.0','elide-core'),
       ('3.0.0','elide-core'),
       ('4.0.0','elide-core'),
       ('5.0.0','elide-core'),
       ('6.0.0','elide-core'),
       ('7.0.0','elide-core');

    INSERT INTO Downloads (group_id, product_id, date, downloads) VALUES
            ('com.example.repository','elide-core','2020-01-01', 10),
            ('com.example.repository','elide-core','2020-01-02', 11),
            ('com.example.repository','elide-core','2020-01-03', 14);
        </sql>
    </changeSet>
    <changeSet author="admin" id="1539122271">
        <sql>
    CREATE SEQUENCE POST_SEQ START WITH 6;

    CREATE TABLE Post (
       id integer NOT NULL,
       entity_id varchar(36) NOT NULL,
       title varchar(255) NOT NULL,
       content varchar(255) NOT NULL,
       content_html varchar(255) NOT NULL,
       parent_id integer,
       PRIMARY KEY (id),
       FOREIGN KEY (parent_id) REFERENCES Post(id),
       UNIQUE (entity_id)
    );

    INSERT INTO Post (id, entity_id, title, content, content_html) VALUES (1, '9b2f710d-9046-4f8c-95ee-1a3884d6d136', 'Getting Started', 'So You Want An API?', 'So You Want An API?');
    INSERT INTO Post (id, entity_id, title, content, content_html) VALUES (2, '31b129a7-d3e8-494d-b368-cc4aa901eb81', 'Features', 'Common API Features', 'Common API Features');
    INSERT INTO Post (id, entity_id, title, content, content_html) VALUES (3, 'f8174b67-6dc4-42a2-9e5e-c8295561f47a', 'Data Models', 'Elide generates its API entirely based on the concept of data models.', 'Elide generates its API entirely based on the concept of data models.');
    INSERT INTO Post (id, entity_id, title, content, content_html) VALUES (4, '8066f23e-e28e-4e4f-8a32-b65f2b57ff98', 'Security', 'Core Concepts', 'Core Concepts');
    INSERT INTO Post (id, entity_id, title, content, content_html) VALUES (5, '6328658e-43f2-4a2e-9c79-35324a0140ed', 'Analytic Query Support', 'Elide includes a semantic modeling layer and analytic query API for OLAP style queries against your database.', 'Elide includes a semantic modeling layer and analytic query API for OLAP style queries against your database.');

    CREATE SEQUENCE NOTE_SEQ START WITH 6;

    CREATE TABLE Note (
       id integer NOT NULL,
       title varchar(255) NOT NULL,
       content varchar(255) NOT NULL,
       content_html varchar(255) NOT NULL,
       parent_id integer,
       PRIMARY KEY (id),
       FOREIGN KEY (parent_id) REFERENCES Note(id)
    );

    INSERT INTO Note (id, title, content, content_html) VALUES (1, 'Getting Started', 'So You Want An API?', 'So You Want An API?');
    INSERT INTO Note (id, title, content, content_html) VALUES (2, 'Features', 'Common API Features', 'Common API Features');
    INSERT INTO Note (id, title, content, content_html) VALUES (3, 'Data Models', 'Elide generates its API entirely based on the concept of data models.', 'Elide generates its API entirely based on the concept of data models.');
    INSERT INTO Note (id, title, content, content_html) VALUES (4, 'Security', 'Core Concepts', 'Core Concepts');
    INSERT INTO Note (id, title, content, content_html) VALUES (5, 'Analytic Query Support', 'Elide includes a semantic modeling layer and analytic query API for OLAP style queries against your database.', 'Elide includes a semantic modeling layer and analytic query API for OLAP style queries against your database.');
        </sql>
    </changeSet>
    
</databaseChangeLog>
